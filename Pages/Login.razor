@page "/"
@page "/login"
@using Super_Jew_2._0.Services
@using Super_Jew_2._0.Models
@using Super_Jew_2._0.Backend
@inject AuthenticationService AuthenticationService
@inject NavigationManager NavigationManager
@inject ILoginService LoginService

<h3>Login</h3>

<EditForm Model="@loginModel" OnValidSubmit="@HandleLogin">
    <InputText id="username" @bind-Value="@loginModel.Username" />
    <InputText id="password" type="password" @bind-Value="@loginModel.Password" />
    <button type="submit">Login</button>
</EditForm>

@code {
    private LoginModel loginModel = new LoginModel();

    private async Task HandleLogin()
    {
        var user = await LoginService.GetFollowedShulsForUser(loginModel.Username, loginModel.Password);
        if (user != null && !string.IsNullOrEmpty(user.AccountType))
        {
            //AuthenticationService.Login(user);
            
    // Navigate based on the AccountType
            switch (user.AccountType.ToLower())
            {
                case "admin":
                    NavigationManager.NavigateTo("/admin-dashboard");
                    break;
                case "user":
                    NavigationManager.NavigateTo("/user-dashboard");
                    break;
                case "gabbai":
                    NavigationManager.NavigateTo("/gabbai-dashboard");
                    break;
                default:
    // Handle unknown account type or show an error message
                    break;
            }
        }
        else
        {
    // Handle login failure, show an error message, etc.
        }
    }
}